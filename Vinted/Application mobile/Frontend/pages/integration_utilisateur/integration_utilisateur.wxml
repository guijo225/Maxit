<!-- Conteneur principal de la page avec défilement vertical -->

<page_couverture></page_couverture>
<scroll-view class="integrer" scroll-y="true" show-scrollbar="false">
    <!-- Premier conteneur pour le bouton et la description -->
    <view class="conteneur_premier">
        <view class="bouton" bindtap="openModal">Intégrer</view>

        <view class="description">Description</view>
        <view class="description_text {{isExpanded ? 'expanded' : 'collapsed'}}">
            <text style="position:relative;">Lorem ipsum dolor sit amet consectetur adipisicing elit. Quo adipisci consectetur aperiam natus consequuntur. Dolorem deserunt dicta impedit quia sapiente quos minus laborum, sint quisquam eligendi cum, vero, atque voluptate!</text>
            <text style="position: relative;">Lorem ipsum dolor sit amet consectetur adipisicing elit.</text>
            <text>Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptas quae reprehenderit ipsum minus a sed quidem, nisi maiores suscipit enim quasi impedit delectus sunt possimus! Quibusdam quod enim voluptatem at?</text>
            <text>Lorem ipsum dolor sit, amet consectetur adipisicing elit. Vitae enim a rerum vero suscipit fugiat sit veritatis, blanditiis neque, deleniti, quasi facere ipsum omnis illo necessitatibus labore asperiores reiciendis veniam.</text>
            <text>Lorem ipsum dolor sit amet consectetur adipisicing elit. Quia blanditiis repellat perferendis vel quas illum distinctio rem, fuga non voluptates reprehenderit asperiores ex obcaecati sit unde in exercitationem autem maiores.</text>
        </view>
        <view class="voir_plus" bindtap="toggleText" style="position: relative; left: 55rpx; top: 171rpx">
            {{isExpanded ? 'voir moins' : 'voir plus'}}
        </view>
    </view>

    <!-- Second conteneur pour les avis utilisateurs -->
    <view class="conteneur_second" style="position: relative; left: -1rpx; top: 0rpx">
        <view class="Avis">Note & Avis d'utilisateurs</view>
        <view class="Avis_view avis-{{index}}" wx:for="{{avisList}}" wx:key="id">
            <view class="ensemble">
                <image src="{{item.avatar}}" class="avatar" />
                <view class="nom">{{item.nom}}</view>
                <view class="note">{{item.note}}</view>
            </view>
            <view class="description_avis">
                <text class="{{item.expanded ? 'full-text' : 'truncated-text'}}">{{item.description}}</text>
                <view class="voir_plus_avis" wx:if="{{item.showButton}}" bindtap="toggleExpand" data-index="{{index}}">
                    {{item.expanded ? 'Voir moins' : 'Voir plus'}}
                </view>
            </view>
        </view>
    </view>

    <!-- Modal pour l'intégration avec liste scrollable et réorganisation -->
    <view wx:if="{{showModal}}" class="modal-overlay" bindtap="closeModal">
        <view class="modal-container1" catchtap="preventClose">
            <!-- En-tête de la modal -->
            <view class="modal-header1">
                <view class="modal-title-container1">
                    <text class="modal-title1">Modifier l'ordre de la tontine</text>
                </view>
                <view class="close-button" bindtap="closeModal">
                    <image src="../../images/mingcute_close-fill.png" class="close-icon" />
                </view>
            </view>

            <!-- Corps de la modal avec liste scrollable -->
            <scroll-view scroll-y="true" class="modal-scroll1" enhanced="true">
                <view class="modal-body1">
                    <!-- Conteneur pour la liste des membres -->
                    <view class="modal-background">
                        <!-- Boucle dynamique sur la liste des membres -->
                        <view class="member-item" wx:for="{{memberList}}" wx:key="index" data-index="{{index}}" bindtouchstart="onTouchStart" bindtouchmove="onTouchMove" bindtouchend="onTouchEnd">
                            <text class="member-text">{{index + 1}}. {{item}}</text>
                            <!-- Séparateur sauf pour le dernier élément -->
                            <view wx:if="{{index < memberList.length - 1}}" class="separator"></view>
                        </view>
                    </view>
                    <!-- Bouton de validation -->
                    <view class="modal-footer">
                        <view class="confirm-button" bindtap="validateOrder">
                            Valider
                        </view>
                    </view>
                </view>
            </scroll-view>
        </view>
    </view>

</scroll-view>